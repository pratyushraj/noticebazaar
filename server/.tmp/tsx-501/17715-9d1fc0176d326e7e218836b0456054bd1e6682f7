{"code":"import{Router}from\"express\";import{createBrandReplyToken,revokeBrandReplyToken,getAuditSummary}from\"../services/brandReplyTokenService.js\";const router=Router();router.post(\"/\",async(req,res)=>{try{const userId=req.user?.id;if(!userId){return res.status(401).json({success:false,error:\"Unauthorized\"})}const{dealId,expiresAt}=req.body;if(!dealId){return res.status(400).json({success:false,error:\"dealId is required\"})}let expiresDate=null;if(expiresAt){expiresDate=new Date(expiresAt);if(isNaN(expiresDate.getTime())){return res.status(400).json({success:false,error:\"Invalid expiresAt format. Use ISO 8601 date string or null.\"})}}const token=await createBrandReplyToken({dealId,creatorId:userId,expiresAt:expiresDate});return res.json({success:true,token:{id:token.id,deal_id:token.deal_id,created_at:token.created_at,expires_at:token.expires_at}})}catch(error){console.error(\"[BrandReplyTokens] Error:\",error);return res.status(500).json({success:false,error:error.message||\"Internal server error\"})}});router.delete(\"/:tokenId\",async(req,res)=>{try{const userId=req.user?.id;if(!userId){return res.status(401).json({success:false,error:\"Unauthorized\"})}const{tokenId}=req.params;if(!tokenId){return res.status(400).json({success:false,error:\"tokenId is required\"})}await revokeBrandReplyToken(tokenId,userId);return res.json({success:true,message:\"Token revoked successfully\"})}catch(error){console.error(\"[BrandReplyTokens] Error:\",error);return res.status(500).json({success:false,error:error.message||\"Internal server error\"})}});router.get(\"/audit/:dealId\",async(req,res)=>{try{const userId=req.user?.id;if(!userId){return res.status(401).json({success:false,error:\"Unauthorized\"})}const{dealId}=req.params;if(!dealId){return res.status(400).json({success:false,error:\"dealId is required\"})}const summary=await getAuditSummary(dealId,userId);return res.json({success:true,audit:summary})}catch(error){console.error(\"[BrandReplyTokens] Error:\",error);return res.status(500).json({success:false,error:error.message||\"Internal server error\"})}});var brandReplyTokens_default=router;export{brandReplyTokens_default as default};\n","warnings":[],"map":{"version":3,"mappings":"AAIA,OAAS,WAAwB,UAGjC,OAAS,sBAAuB,sBAAuB,oBAAuB,wCAE9E,MAAM,OAAS,OAAO,EAItB,OAAO,KAAK,IAAK,MAAO,IAA2B,MAAkB,CACnE,GAAI,CACF,MAAM,OAAS,IAAI,MAAM,GACzB,GAAI,CAAC,OAAQ,CACX,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,cACT,CAAC,CACH,CAEA,KAAM,CAAE,OAAQ,SAAU,EAAI,IAAI,KAElC,GAAI,CAAC,OAAQ,CACX,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,oBACT,CAAC,CACH,CAGA,IAAI,YAA2B,KAC/B,GAAI,UAAW,CACb,YAAc,IAAI,KAAK,SAAS,EAChC,GAAI,MAAM,YAAY,QAAQ,CAAC,EAAG,CAChC,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,6DACT,CAAC,CACH,CACF,CAEA,MAAM,MAAQ,MAAM,sBAAsB,CACxC,OACA,UAAW,OACX,UAAW,WACb,CAAC,EAED,OAAO,IAAI,KAAK,CACd,QAAS,KACT,MAAO,CACL,GAAI,MAAM,GACV,QAAS,MAAM,QACf,WAAY,MAAM,WAClB,WAAY,MAAM,UACpB,CACF,CAAC,CACH,OAAS,MAAY,CACnB,QAAQ,MAAM,4BAA6B,KAAK,EAChD,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,MAAM,SAAW,uBAC1B,CAAC,CACH,CACF,CAAC,EAID,OAAO,OAAO,YAAa,MAAO,IAA2B,MAAkB,CAC7E,GAAI,CACF,MAAM,OAAS,IAAI,MAAM,GACzB,GAAI,CAAC,OAAQ,CACX,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,cACT,CAAC,CACH,CAEA,KAAM,CAAE,OAAQ,EAAI,IAAI,OAExB,GAAI,CAAC,QAAS,CACZ,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,qBACT,CAAC,CACH,CAEA,MAAM,sBAAsB,QAAS,MAAM,EAE3C,OAAO,IAAI,KAAK,CACd,QAAS,KACT,QAAS,4BACX,CAAC,CACH,OAAS,MAAY,CACnB,QAAQ,MAAM,4BAA6B,KAAK,EAChD,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,MAAM,SAAW,uBAC1B,CAAC,CACH,CACF,CAAC,EAID,OAAO,IAAI,iBAAkB,MAAO,IAA2B,MAAkB,CAC/E,GAAI,CACF,MAAM,OAAS,IAAI,MAAM,GACzB,GAAI,CAAC,OAAQ,CACX,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,cACT,CAAC,CACH,CAEA,KAAM,CAAE,MAAO,EAAI,IAAI,OAEvB,GAAI,CAAC,OAAQ,CACX,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,oBACT,CAAC,CACH,CAEA,MAAM,QAAU,MAAM,gBAAgB,OAAQ,MAAM,EAEpD,OAAO,IAAI,KAAK,CACd,QAAS,KACT,MAAO,OACT,CAAC,CACH,OAAS,MAAY,CACnB,QAAQ,MAAM,4BAA6B,KAAK,EAChD,OAAO,IAAI,OAAO,GAAG,EAAE,KAAK,CAC1B,QAAS,MACT,MAAO,MAAM,SAAW,uBAC1B,CAAC,CACH,CACF,CAAC,EAED,IAAO,yBAAQ","names":[],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/routes/brandReplyTokens.ts"],"sourcesContent":[null]}}