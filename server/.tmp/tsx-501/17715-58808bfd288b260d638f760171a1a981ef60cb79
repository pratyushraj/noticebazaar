{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{callLLM}from\"./aiContractAnalysis.js\";async function classifyComplaintSeverity(description,category,categoryName,amount,issueType){try{const amountText=amount?`\\u20B9${amount.toLocaleString(\"en-IN\")}`:\"Not specified\";const categoryText=categoryName||category;const prompt=`You are a legal triage assistant. Analyze this consumer complaint and classify its severity for internal prioritization.\n\nComplaint Details:\n- Category: ${categoryText}\n- Issue Type: ${issueType}\n- Amount Involved: ${amountText}\n- Description: ${description}\n\nClassify the severity based on:\n1. Financial impact (higher amounts = higher severity)\n2. Legal complexity (contract disputes, fraud = higher severity)\n3. Urgency (time-sensitive issues = higher severity)\n4. Potential for escalation (refund delays, service failures = medium-high)\n\nReturn ONLY a valid JSON object with this exact structure:\n{\n  \"severity\": \"low\" | \"medium\" | \"high\",\n  \"reason\": \"Brief explanation (1-2 sentences)\",\n  \"confidence\": <number between 0 and 1>\n}\n\nGuidelines:\n- LOW: Minor issues, small amounts (<\\u20B91000), simple refund requests, non-urgent\n- MEDIUM: Moderate amounts (\\u20B91000-\\u20B910000), service quality issues, standard disputes\n- HIGH: Large amounts (>\\u20B910000), fraud allegations, contract breaches, urgent legal matters, potential legal action\n\nBe conservative - when in doubt, choose medium.`;const response=await callLLM(prompt);let jsonMatch=response.match(/\\{[\\s\\S]*\\}/);if(!jsonMatch){jsonMatch=[response]}const classification=JSON.parse(jsonMatch[0]);if(![\"low\",\"medium\",\"high\"].includes(classification.severity)){throw new Error(`Invalid severity: ${classification.severity}`)}const confidence=Math.max(0,Math.min(1,classification.confidence||.5));return{severity:classification.severity,confidence_score:confidence}}catch(error){console.error(\"[ComplaintSeverity] AI classification failed:\",error);return{severity:\"medium\",confidence_score:0}}}__name(classifyComplaintSeverity,\"classifyComplaintSeverity\");export{classifyComplaintSeverity};\n","warnings":[],"map":{"version":3,"mappings":"kHAIA,OAAS,YAAe,0BAYxB,eAAsB,0BACpB,YACA,SACA,aACA,OACA,UAC4E,CAC5E,GAAI,CACF,MAAM,WAAa,OAAS,SAAI,OAAO,eAAe,OAAO,CAAC,GAAK,gBACnE,MAAM,aAAe,cAAgB,SAErC,MAAM,OAAS;AAAA;AAAA;AAAA,cAGL,YAAY;AAAA,gBACV,SAAS;AAAA,qBACJ,UAAU;AAAA,iBACd,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAsBxB,MAAM,SAAW,MAAM,QAAQ,MAAM,EAGrC,IAAI,UAAY,SAAS,MAAM,aAAa,EAC5C,GAAI,CAAC,UAAW,CAEd,UAAY,CAAC,QAAQ,CACvB,CAEA,MAAM,eAAyC,KAAK,MAAM,UAAU,CAAC,CAAC,EAGtE,GAAI,CAAC,CAAC,MAAO,SAAU,MAAM,EAAE,SAAS,eAAe,QAAQ,EAAG,CAChE,MAAM,IAAI,MAAM,qBAAqB,eAAe,QAAQ,EAAE,CAChE,CAGA,MAAM,WAAa,KAAK,IAAI,EAAG,KAAK,IAAI,EAAG,eAAe,YAAc,EAAG,CAAC,EAE5E,MAAO,CACL,SAAU,eAAe,SACzB,iBAAkB,UACpB,CACF,OAAS,MAAY,CACnB,QAAQ,MAAM,gDAAiD,KAAK,EAEpE,MAAO,CACL,SAAU,SACV,iBAAkB,CACpB,CACF,CACF,CAtEsB","names":[],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/services/complaintSeverityClassifier.ts"],"sourcesContent":[null]}}