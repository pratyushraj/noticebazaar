{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import crypto from\"crypto\";const SECRET=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_JWT_SECRET||\"fallback-secret-key\";function generateActionToken(requestId,action,expiresInHours=24*7){const version=\"v1\";const expiry=Date.now()+expiresInHours*60*60*1e3;const data=`${version}.${requestId}.${action}.${expiry}`;const signature=crypto.createHmac(\"sha256\",SECRET).update(data).digest(\"base64url\");return`${data}.${signature}`}__name(generateActionToken,\"generateActionToken\");function verifyActionToken(token){try{const parts=token.split(\".\");if(parts.length!==5)return{valid:false};const[version,requestId,action,expiryStr,signature]=parts;const data=`${version}.${requestId}.${action}.${expiryStr}`;const expectedSignature=crypto.createHmac(\"sha256\",SECRET).update(data).digest(\"base64url\");if(signature!==expectedSignature){return{valid:false}}const expiry=parseInt(expiryStr,10);if(Date.now()>expiry){return{valid:false,expired:true}}return{valid:true,requestId,action}}catch(err){return{valid:false}}}__name(verifyActionToken,\"verifyActionToken\");export{generateActionToken,verifyActionToken};\n","warnings":[],"map":{"version":3,"mappings":"kHACA,OAAO,WAAY,SAEnB,MAAM,OAAS,QAAQ,IAAI,2BAA6B,QAAQ,IAAI,qBAAuB,sBAMpF,SAAS,oBAAoB,UAAmB,OAA8B,eAAiB,GAAK,EAAW,CAClH,MAAM,QAAU,KAChB,MAAM,OAAS,KAAK,IAAI,EAAI,eAAiB,GAAK,GAAK,IACvD,MAAM,KAAO,GAAG,OAAO,IAAI,SAAS,IAAI,MAAM,IAAI,MAAM,GAExD,MAAM,UAAY,OACb,WAAW,SAAU,MAAM,EAC3B,OAAO,IAAI,EACX,OAAO,WAAW,EAEvB,MAAO,GAAG,IAAI,IAAI,SAAS,EAC/B,CAXgB,kDAgBT,SAAS,kBAAkB,MAA2F,CACzH,GAAI,CACA,MAAM,MAAQ,MAAM,MAAM,GAAG,EAC7B,GAAI,MAAM,SAAW,EAAG,MAAO,CAAE,MAAO,KAAM,EAE9C,KAAM,CAAC,QAAS,UAAW,OAAQ,UAAW,SAAS,EAAI,MAC3D,MAAM,KAAO,GAAG,OAAO,IAAI,SAAS,IAAI,MAAM,IAAI,SAAS,GAE3D,MAAM,kBAAoB,OACrB,WAAW,SAAU,MAAM,EAC3B,OAAO,IAAI,EACX,OAAO,WAAW,EAEvB,GAAI,YAAc,kBAAmB,CACjC,MAAO,CAAE,MAAO,KAAM,CAC1B,CAEA,MAAM,OAAS,SAAS,UAAW,EAAE,EACrC,GAAI,KAAK,IAAI,EAAI,OAAQ,CACrB,MAAO,CAAE,MAAO,MAAO,QAAS,IAAK,CACzC,CAEA,MAAO,CAAE,MAAO,KAAM,UAAW,MAAO,CAC5C,OAAS,IAAK,CACV,MAAO,CAAE,MAAO,KAAM,CAC1B,CACJ,CA1BgB","names":[],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/utils/token.ts"],"sourcesContent":[null]}}