{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{supabase}from\"../lib/supabase.js\";import{qualifiesForRateLearning,updateLearnedRateForCreator}from\"./creatorRateService.js\";function getDeviceInfo(userAgent){const deviceInfo={userAgent,timestamp:new Date().toISOString()};if(/mobile|android|iphone|ipad/i.test(userAgent)){deviceInfo.type=\"mobile\"}else if(/tablet|ipad/i.test(userAgent)){deviceInfo.type=\"tablet\"}else{deviceInfo.type=\"desktop\"}if(/chrome/i.test(userAgent)&&!/edge|edg/i.test(userAgent)){deviceInfo.browser=\"Chrome\"}else if(/firefox/i.test(userAgent)){deviceInfo.browser=\"Firefox\"}else if(/safari/i.test(userAgent)&&!/chrome/i.test(userAgent)){deviceInfo.browser=\"Safari\"}else if(/edge|edg/i.test(userAgent)){deviceInfo.browser=\"Edge\"}else{deviceInfo.browser=\"Unknown\"}return deviceInfo}__name(getDeviceInfo,\"getDeviceInfo\");function getClientIp(req){const forwarded=req.headers[\"x-forwarded-for\"];const ip=forwarded?typeof forwarded===\"string\"?forwarded.split(\",\")[0]:forwarded[0]:req.socket.remoteAddress||req.ip||\"unknown\";return ip.trim()}__name(getClientIp,\"getClientIp\");async function signContractAsBrand(request,tokenInfo){try{if(!request.otpVerified){return{success:false,error:\"OTP verification is required before signing\"}}let validatedTokenInfo=tokenInfo;if(!validatedTokenInfo){const{getContractReadyTokenInfo}=await import(\"./contractReadyTokenService.js\").then(s=>{const e=\"default\";return s[e]&&typeof s[e]==\"object\"&&\"__esModule\"in s[e]?s[e]:s});validatedTokenInfo=await getContractReadyTokenInfo(request.token);if(!validatedTokenInfo){return{success:false,error:\"Invalid or expired token\"}}}let deal=validatedTokenInfo.deal;if(!deal||!deal.id){const{data:tokenData}=await supabase.from(\"contract_ready_tokens\").select(\"submission_id, deal_id\").eq(\"id\",request.token).maybeSingle();if(tokenData?.submission_id){const{data:submission}=await supabase.from(\"deal_details_submissions\").select(\"*, deal_details_tokens!inner(*)\").eq(\"id\",tokenData.submission_id).maybeSingle();if(submission&&submission.form_data){const formData=submission.form_data;const dealData={creator_id:submission.creator_id,brand_name:formData.brandName||\"Brand\",deal_amount:formData.dealType===\"paid\"&&formData.paymentAmount?parseFloat(formData.paymentAmount)||0:0,deliverables:JSON.stringify(formData.deliverables||[]),due_date:formData.deadline||new Date().toISOString().split(\"T\")[0],payment_expected_date:formData.deadline||new Date().toISOString().split(\"T\")[0],status:\"SIGNED_BY_BRAND\",platform:\"Other\",deal_type:formData.dealType||\"paid\",created_via:\"deal_details_form\",brand_address:formData.companyAddress||null,brand_email:formData.companyEmail||null};const{data:newDeal,error:dealError}=await supabase.from(\"brand_deals\").insert(dealData).select().single();if(dealError||!newDeal){console.error(\"[ContractSigningService] Failed to create deal from submission:\",dealError);return{success:false,error:\"Failed to create deal\"}}deal=newDeal;request.dealId=newDeal.id;await supabase.from(\"deal_details_submissions\").update({deal_id:newDeal.id}).eq(\"id\",tokenData.submission_id);if(tokenData.submission_id){await supabase.from(\"contract_ready_tokens\").update({deal_id:newDeal.id}).eq(\"id\",request.token)}}}}if(deal.id!==request.dealId){return{success:false,error:\"Deal ID mismatch\"}}const{data:existingSignature,error:checkError}=await supabase.from(\"contract_signatures\").select(\"*\").eq(\"deal_id\",request.dealId).eq(\"signer_role\",\"brand\").maybeSingle();if(checkError&&checkError.code!==\"PGRST116\"){console.error(\"[ContractSigningService] Error checking existing signature:\",checkError);return{success:false,error:\"Failed to check existing signature\"}}if(existingSignature&&existingSignature.signed){return{success:false,error:\"Contract has already been signed\"}}let contractSnapshotHtml=request.contractSnapshotHtml;if(!contractSnapshotHtml&&deal.contract_file_url){contractSnapshotHtml=`Contract URL: ${deal.contract_file_url}\nSigned at: ${new Date().toISOString()}`}const signatureData={deal_id:request.dealId,signer_role:\"brand\",signer_name:request.signerName,signer_email:request.signerEmail,signer_phone:request.signerPhone||null,ip_address:request.ipAddress,user_agent:request.userAgent,device_info:request.deviceInfo||getDeviceInfo(request.userAgent),otp_verified:true,otp_verified_at:request.otpVerifiedAt||new Date().toISOString(),signed:true,signed_at:new Date().toISOString(),contract_version_id:request.contractVersionId||deal.contract_version||\"v3\",contract_snapshot_html:contractSnapshotHtml};let signature;if(existingSignature){const{data:updated,error:updateError}=await supabase.from(\"contract_signatures\").update(signatureData).eq(\"id\",existingSignature.id).select().single();if(updateError||!updated){console.error(\"[ContractSigningService] Error updating signature:\",updateError);return{success:false,error:\"Failed to update signature record\"}}signature=updated}else{const{data:created,error:createError}=await supabase.from(\"contract_signatures\").insert(signatureData).select().single();if(createError||!created){console.error(\"[ContractSigningService] Error creating signature:\",createError);return{success:false,error:\"Failed to create signature record\"}}signature=created}const creatorSignature=await getSignature(request.dealId,\"creator\");const newStatus=creatorSignature&&creatorSignature.signed?\"FULLY_EXECUTED\":\"SIGNED_BY_BRAND\";try{const{error:updateDealError}=await supabase.from(\"brand_deals\").update({brand_response_status:\"accepted_verified\",brand_response_at:new Date().toISOString(),status:newStatus,updated_at:new Date().toISOString()}).eq(\"id\",request.dealId);if(updateDealError){console.error(\"[ContractSigningService] Error updating deal status:\",updateDealError)}else{console.log(`[ContractSigningService] Deal status updated to ${newStatus}`);if(newStatus===\"FULLY_EXECUTED\"&&qualifiesForRateLearning(deal)){console.log(`[ContractSigningService] Deal qualifies for rate learning, updating creator ${deal.creator_id}`);updateLearnedRateForCreator(deal.creator_id,deal.deal_amount).catch(err=>{console.error(\"[ContractSigningService] Failed to update learned rate:\",err)})}}}catch(dealUpdateError){console.error(\"[ContractSigningService] Deal status update failed (non-fatal):\",dealUpdateError)}try{await supabase.from(\"deal_action_logs\").insert({deal_id:request.dealId,user_id:null,event:\"BRAND_SIGNED\",metadata:{signer_email:request.signerEmail,signed_at:signature.signed_at}})}catch(logErr){console.warn(\"[ContractSigningService] BRAND_SIGNED log failed:\",logErr)}try{await supabase.from(\"analytics_events\").insert({event_type:\"contract_signed\",deal_id:request.dealId,creator_id:deal.creator_id,metadata:{signer_role:\"brand\",signer_email:request.signerEmail,signature_id:signature.id,ip_address:request.ipAddress,device_type:request.deviceInfo?.type||\"unknown\"},created_at:new Date().toISOString()})}catch(analyticsError){console.error(\"[ContractSigningService] Activity logging failed (non-fatal):\",analyticsError)}try{const{sendBrandSigningConfirmationEmail,sendCreatorSigningNotificationEmail}=await import(\"./contractSigningEmailService.js\").then(s=>{const e=\"default\";return s[e]&&typeof s[e]==\"object\"&&\"__esModule\"in s[e]?s[e]:s});const{generateCreatorSigningToken}=await import(\"./creatorSigningTokenService.js\").then(s=>{const e=\"default\";return s[e]&&typeof s[e]==\"object\"&&\"__esModule\"in s[e]?s[e]:s});const{data:creator,error:creatorError}=await supabase.from(\"profiles\").select(\"email, first_name, last_name, business_name\").eq(\"id\",deal.creator_id).maybeSingle();if(creatorError){console.error(\"[ContractSigningService] Error fetching creator:\",creatorError)}const creatorData=creator;let creatorEmail=creatorData?.email||\"\";let creatorName=creatorData?.business_name||(creatorData?.first_name&&creatorData?.last_name?`${creatorData.first_name} ${creatorData.last_name}`:creatorData?.first_name||\"Creator\");if(!creatorEmail&&deal.creator_id){console.log(\"[ContractSigningService] Email not in profiles, fetching from auth admin...\");try{const{data:{user},error:authError}=await supabase.auth.admin.getUserById(deal.creator_id);if(user&&user.email){creatorEmail=user.email;console.log(\"[ContractSigningService] Creator email found via auth admin:\",creatorEmail);if(creatorName===\"Creator\"&&creatorEmail){creatorName=creatorEmail.split(\"@\")[0]}}else if(authError){console.error(\"[ContractSigningService] Auth admin fetch failed:\",authError)}}catch(authFetchError){console.error(\"[ContractSigningService] Exception fetching from auth:\",authFetchError)}}let creatorSigningToken;if(creatorEmail&&deal.creator_id){const tokenResult=await generateCreatorSigningToken(deal.id,deal.creator_id,creatorEmail);if(tokenResult.success){creatorSigningToken=tokenResult.token;console.log(\"[ContractSigningService] Creator signing token generated:\",creatorSigningToken)}else{console.error(\"[ContractSigningService] Failed to generate creator signing token:\",tokenResult.error)}}const deliverablesList=deal.deliverables?typeof deal.deliverables===\"string\"?deal.deliverables.includes(\"[\")?JSON.parse(deal.deliverables):[deal.deliverables]:Array.isArray(deal.deliverables)?deal.deliverables:[]:[];const emailData={dealId:deal.id,brandName:deal.brand_name||\"Brand\",creatorName,brandEmail:request.signerEmail,creatorEmail,dealAmount:deal.deal_amount||deal.amount?parseFloat((deal.deal_amount||deal.amount).toString()):void 0,dealType:deal.deal_type||\"paid\",deliverables:deliverablesList.map(d=>typeof d===\"string\"?d:`${d.quantity||1}x ${d.contentType||\"Content\"} on ${d.platform||\"Platform\"}`),deadline:deal.due_date||void 0,contractUrl:deal.contract_file_url||void 0,creatorSigningToken};if(!creatorEmail){console.error(\"[ContractSigningService] CRITICAL: Creator email not found! Cannot send notification. Creator ID:\",deal.creator_id)}const[brandResult,creatorResult]=await Promise.all([sendBrandSigningConfirmationEmail(request.signerEmail,request.signerName,emailData),creatorEmail?sendCreatorSigningNotificationEmail(creatorEmail,creatorName,emailData):Promise.resolve({success:false,error:\"Creator email not found\"})]);if(brandResult.success){console.log(\"[ContractSigningService] Brand confirmation email sent\")}else{console.error(\"[ContractSigningService] Failed to send brand confirmation email:\",brandResult.error||\"Unknown error\")}if(creatorResult.success){console.log(\"[ContractSigningService] Creator notification email sent\")}else{const creatorError2=creatorResult.error;console.error(\"[ContractSigningService] Failed to send creator notification email:\",creatorError2||\"Unknown error\")}}catch(emailServiceError){console.error(\"[ContractSigningService] Email service error (non-fatal):\",emailServiceError)}return{success:true,signature}}catch(error){console.error(\"[ContractSigningService] Sign contract error:\",error);return{success:false,error:error.message||\"Failed to sign contract\"}}}__name(signContractAsBrand,\"signContractAsBrand\");async function signContractAsCreator(request){try{if(!request.otpVerified){return{success:false,error:\"OTP verification is required before signing\"}}const{data:deal,error:dealError}=await supabase.from(\"brand_deals\").select(\"*\").eq(\"id\",request.dealId).single();if(dealError||!deal){return{success:false,error:\"Deal not found\"}}const dealData=deal;if(dealData.creator_id!==request.creatorId){return{success:false,error:\"You can only sign contracts for your own deals\"}}const brandSignature=await getSignature(request.dealId,\"brand\");const{data:existingSignature,error:checkError}=await supabase.from(\"contract_signatures\").select(\"*\").eq(\"deal_id\",request.dealId).eq(\"signer_role\",\"creator\").maybeSingle();if(checkError&&checkError.code!==\"PGRST116\"){console.error(\"[ContractSigningService] Error checking existing signature:\",checkError);return{success:false,error:\"Failed to check existing signature\"}}if(existingSignature&&existingSignature.signed){return{success:false,error:\"Contract has already been signed by creator\"}}let contractSnapshotHtml=request.contractSnapshotHtml;if(!contractSnapshotHtml&&dealData.contract_file_url){contractSnapshotHtml=`Contract URL: ${dealData.contract_file_url}\nSigned at: ${new Date().toISOString()}`}const signatureData={deal_id:request.dealId,signer_role:\"creator\",signer_name:request.signerName,signer_email:request.signerEmail,signer_phone:request.signerPhone||null,ip_address:request.ipAddress,user_agent:request.userAgent,device_info:request.deviceInfo||null,otp_verified:request.otpVerified,otp_verified_at:request.otpVerifiedAt||new Date().toISOString(),signed:true,signed_at:new Date().toISOString(),contract_version_id:request.contractVersionId||dealData.contract_version||\"v3\",contract_snapshot_html:contractSnapshotHtml||null};let signature;if(existingSignature){const existingSig=existingSignature;const{data:updated,error:updateError}=await supabase.from(\"contract_signatures\").update(signatureData).eq(\"id\",existingSig.id).select().single();if(updateError){console.error(\"[ContractSigningService] Error updating signature:\",updateError);return{success:false,error:\"Failed to update signature\"}}signature=updated}else{const{data:created,error:createError}=await supabase.from(\"contract_signatures\").insert(signatureData).select().single();if(createError){console.error(\"[ContractSigningService] Error creating signature:\",createError);return{success:false,error:\"Failed to create signature\"}}signature=created}try{const newStatus=brandSignature&&brandSignature.signed?\"FULLY_EXECUTED\":\"SIGNED_BY_CREATOR\";await supabase.from(\"brand_deals\").update({status:newStatus,updated_at:new Date().toISOString()}).eq(\"id\",request.dealId);console.log(`[ContractSigningService] Deal status updated to ${newStatus}`);if(newStatus===\"FULLY_EXECUTED\"&&qualifiesForRateLearning(deal)){console.log(`[ContractSigningService] Deal qualifies for rate learning, updating creator ${deal.creator_id}`);updateLearnedRateForCreator(deal.creator_id,deal.deal_amount).catch(err=>{console.error(\"[ContractSigningService] Failed to update learned rate:\",err)})}}catch(updateError){console.error(\"[ContractSigningService] Error updating deal status:\",updateError)}try{await supabase.from(\"deal_action_logs\").insert({deal_id:request.dealId,user_id:request.creatorId,event:\"CREATOR_SIGNED\",metadata:{signer_email:request.signerEmail,signed_at:signature.signed_at}})}catch(logErr){console.warn(\"[ContractSigningService] CREATOR_SIGNED log failed:\",logErr)}try{await supabase.from(\"analytics_events\").insert({event_type:\"contract_signed\",deal_id:request.dealId,creator_id:request.creatorId,metadata:{signer_role:\"creator\",signer_email:request.signerEmail,signature_id:signature.id,ip_address:request.ipAddress,device_type:request.deviceInfo?.type||\"unknown\"},created_at:new Date().toISOString()})}catch(analyticsError){console.error(\"[ContractSigningService] Creator activity logging failed (non-fatal):\",analyticsError)}try{const{sendCreatorSigningConfirmationEmail,sendBrandSigningNotificationEmail}=await import(\"./contractSigningEmailService.js\").then(s=>{const e=\"default\";return s[e]&&typeof s[e]==\"object\"&&\"__esModule\"in s[e]?s[e]:s});const{data:brandDeal,error:brandDealError}=await supabase.from(\"brand_deals\").select(\"brand_name, brand_email, deal_amount, amount, deal_type, deliverables, due_date, contract_file_url\").eq(\"id\",request.dealId).single();if(!brandDealError&&brandDeal){const brandDealData=brandDeal;const deliverablesList=brandDealData.deliverables?typeof brandDealData.deliverables===\"string\"?brandDealData.deliverables.includes(\"[\")?JSON.parse(brandDealData.deliverables):[brandDealData.deliverables]:Array.isArray(brandDealData.deliverables)?brandDealData.deliverables:[]:[];const emailData={dealId:request.dealId,brandName:brandDealData.brand_name||\"Brand\",creatorName:request.signerName,brandEmail:brandDealData.brand_email||\"\",creatorEmail:request.signerEmail,dealAmount:brandDealData.deal_amount||brandDealData.amount?parseFloat((brandDealData.deal_amount||brandDealData.amount).toString()):void 0,dealType:brandDealData.deal_type||\"paid\",deliverables:deliverablesList.map(d=>typeof d===\"string\"?d:`${d.quantity||1}x ${d.contentType||\"Content\"} on ${d.platform||\"Platform\"}`),deadline:brandDealData.due_date||void 0,contractUrl:brandDealData.contract_file_url||void 0};const[creatorConfirmResult,brandNotifyResult]=await Promise.all([sendCreatorSigningConfirmationEmail(request.signerEmail,request.signerName,emailData),emailData.brandEmail?sendBrandSigningNotificationEmail(emailData.brandEmail,emailData.brandName,emailData):Promise.resolve({success:false,error:\"Brand email not found\"})]);if(creatorConfirmResult.success){console.log(\"[ContractSigningService] Creator confirmation email sent\")}else{console.error(\"[ContractSigningService] Failed to send creator confirmation email:\",creatorConfirmResult.error||\"Unknown error\")}if(brandNotifyResult.success){console.log(\"[ContractSigningService] Brand signing notification email sent\")}else{console.error(\"[ContractSigningService] Failed to send brand notification email:\",brandNotifyResult.error||\"Unknown error\")}}}catch(emailServiceError){console.error(\"[ContractSigningService] Email service error (non-fatal):\",emailServiceError)}return{success:true,signature}}catch(error){console.error(\"[ContractSigningService] Sign contract as creator error:\",error);return{success:false,error:error.message||\"Failed to sign contract\"}}}__name(signContractAsCreator,\"signContractAsCreator\");async function getSignature(dealId,signerRole){try{const{data,error}=await supabase.from(\"contract_signatures\").select(\"*\").eq(\"deal_id\",dealId).eq(\"signer_role\",signerRole).maybeSingle();if(error&&error.code!==\"PGRST116\"){console.error(\"[ContractSigningService] Error fetching signature:\",error);return null}return data}catch(error){console.error(\"[ContractSigningService] Get signature error:\",error);return null}}__name(getSignature,\"getSignature\");export{getClientIp,getDeviceInfo,getSignature,signContractAsBrand,signContractAsCreator};\n","warnings":[],"map":{"version":3,"mappings":"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","names":["creatorError"],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/services/contractSigningService.ts"],"sourcesContent":[null]}}