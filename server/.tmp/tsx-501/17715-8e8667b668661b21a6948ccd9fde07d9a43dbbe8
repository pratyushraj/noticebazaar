{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import express from\"express\";import{supabase,supabaseInitialized}from\"../lib/supabase.js\";import{authMiddleware}from\"../middleware/auth.js\";import crypto from\"crypto\";const router=express.Router();function hashIp(ip){if(!ip||ip===\"unknown\")return\"unknown\";const parts=ip.split(\".\");if(parts.length>=3){return`${parts[0]}.${parts[1]}.${parts[2]}.xxx`}return crypto.createHash(\"sha256\").update(ip).digest(\"hex\").substring(0,16)+\"...\"}__name(hashIp,\"hashIp\");function detectDeviceType(userAgent){if(!userAgent)return\"unknown\";const ua=userAgent.toLowerCase();if(ua.includes(\"mobile\")||ua.includes(\"android\")||ua.includes(\"iphone\")){return\"mobile\"}if(ua.includes(\"tablet\")||ua.includes(\"ipad\")){return\"tablet\"}if(ua.includes(\"desktop\")||ua.includes(\"windows\")||ua.includes(\"macintosh\")||ua.includes(\"linux\")){return\"desktop\"}return\"unknown\"}__name(detectDeviceType,\"detectDeviceType\");router.post(\"/track\",async(req,res)=>{try{const{creator_username,event_type,request_id,utm_source,utm_medium,utm_campaign}=req.body;if(!creator_username||!event_type){return res.status(400).json({success:false,error:\"creator_username and event_type are required\"})}if(![\"view\",\"submit\"].includes(event_type)){return res.status(400).json({success:false,error:'event_type must be \"view\" or \"submit\"'})}const normalizedUsername=creator_username.toLowerCase().trim();console.log(\"[CollabAnalytics] Tracking event:\",{event_type,creator_username:normalizedUsername,original_username:creator_username});const{data:creatorByUsername}=await supabase.from(\"profiles\").select(\"id, role, username, instagram_handle\").eq(\"username\",normalizedUsername).maybeSingle();let creator=creatorByUsername;if(!creator){const{data:creatorByInstagram}=await supabase.from(\"profiles\").select(\"id, role, username, instagram_handle\").eq(\"instagram_handle\",normalizedUsername).maybeSingle();creator=creatorByInstagram}if(!creator){console.warn(\"[CollabAnalytics] Creator not found for tracking:\",{slug:normalizedUsername,original:creator_username});if(process.env.NODE_ENV===\"development\"){const{data:allUsernames}=await supabase.from(\"profiles\").select(\"username, role\").limit(10);console.log(\"[CollabAnalytics] Sample usernames in database:\",allUsernames)}return res.status(404).json({success:false,error:\"Creator not found\",details:process.env.NODE_ENV===\"development\"?`Username: ${normalizedUsername}`:void 0})}console.log(\"[CollabAnalytics] Creator found:\",{creator_id:creator.id,username:creator.username,role:creator.role});const clientIp=req.ip||req.socket.remoteAddress||\"unknown\";const userAgent=req.get(\"user-agent\")||\"unknown\";const oneMinuteAgo=new Date(Date.now()-60*1e3).toISOString();const{data:recentEvents}=await supabase.from(\"collab_link_events\").select(\"id\").eq(\"creator_id\",creator.id).eq(\"ip_hash\",hashIp(clientIp)).gte(\"created_at\",oneMinuteAgo).limit(10);if(recentEvents&&recentEvents.length>=10){console.log(\"[CollabAnalytics] Rate limit exceeded for IP:\",hashIp(clientIp));return res.json({success:true,message:\"Event tracked (rate limited)\"})}const eventData={creator_id:creator.id,event_type,request_id:request_id||null,device_type:detectDeviceType(userAgent),utm_source:utm_source||null,utm_medium:utm_medium||null,utm_campaign:utm_campaign||null,ip_hash:hashIp(clientIp),user_agent_hash:crypto.createHash(\"sha256\").update(userAgent).digest(\"hex\").substring(0,16)};const{data:insertedData,error:insertError}=await supabase.from(\"collab_link_events\").insert(eventData).select().single();if(insertError){console.error(\"[CollabAnalytics] Error tracking event:\",insertError);console.error(\"[CollabAnalytics] Event data:\",JSON.stringify(eventData,null,2));console.error(\"[CollabAnalytics] Creator ID:\",creator.id);return res.status(500).json({success:false,error:\"Failed to track event\",details:process.env.NODE_ENV===\"development\"?insertError.message:void 0})}if(process.env.NODE_ENV===\"development\"){console.log(\"[CollabAnalytics] Event tracked successfully:\",{event_type,creator_id:creator.id,inserted_id:insertedData?.id})}res.json({success:true,message:\"Event tracked successfully\"})}catch(error){console.error(\"[CollabAnalytics] Error in POST /track:\",error);res.status(500).json({success:false,error:\"Internal server error\"})}});router.get(\"/\",authMiddleware,async(req,res)=>{try{const userId=req.user.id;const{days=\"30\"}=req.query;const daysNum=parseInt(days.toString(),10);if(isNaN(daysNum)||daysNum<1||daysNum>365){return res.status(400).json({success:false,error:\"days must be between 1 and 365\"})}const startDate=new Date;startDate.setDate(startDate.getDate()-daysNum);const startDateStr=startDate.toISOString();const{data:events,error:eventsError}=await supabase.from(\"collab_link_events\").select(\"event_type, device_type, created_at, ip_hash\").eq(\"creator_id\",userId).gte(\"created_at\",startDateStr).order(\"created_at\",{ascending:false});if(eventsError){const missingSchema=eventsError.code===\"42P01\"||eventsError.code===\"42703\"||/does not exist|relation .* does not exist|column .* does not exist/i.test(eventsError.message||\"\");if(missingSchema){console.warn(\"[CollabAnalytics] Missing table/column in production schema, returning empty analytics:\",eventsError.message);return res.json({success:true,analytics:{period:daysNum,views:{total:0,unique:0,trend:0,trendDirection:\"up\"},submissions:{total:0,trend:0,trendDirection:\"up\"},conversionRate:{value:0,trend:0,trendDirection:\"neutral\"},deviceBreakdown:{mobile:0,desktop:0,tablet:0,unknown:0},recentActivity:[]}})}console.error(\"[CollabAnalytics] Error fetching events:\",eventsError);console.error(\"[CollabAnalytics] Error details:\",JSON.stringify(eventsError,null,2));console.error(\"[CollabAnalytics] User ID:\",userId);console.error(\"[CollabAnalytics] Start date:\",startDateStr);return res.status(500).json({success:false,error:\"Failed to fetch analytics\",details:process.env.NODE_ENV===\"development\"?eventsError.message:void 0})}if(process.env.NODE_ENV===\"development\"){console.log(\"[CollabAnalytics] Fetched events:\",{total:events?.length||0,views:events?.filter(e=>e.event_type===\"view\").length||0,submissions:events?.filter(e=>e.event_type===\"submit\").length||0,userId,startDate:startDateStr})}const views=events?.filter(e=>e.event_type===\"view\").length||0;const submissions=events?.filter(e=>e.event_type===\"submit\").length||0;const conversionRate=views>0?submissions/views*100:0;const viewEvents=events.filter(e=>e.event_type===\"view\");const deviceBreakdown={mobile:viewEvents.filter(e=>e.device_type===\"mobile\").length,desktop:viewEvents.filter(e=>e.device_type===\"desktop\").length,tablet:viewEvents.filter(e=>e.device_type===\"tablet\").length,unknown:viewEvents.filter(e=>e.device_type===\"unknown\").length};const comparisonStartDate=new Date(startDate);comparisonStartDate.setDate(comparisonStartDate.getDate()-daysNum);const comparisonStartDateStr=comparisonStartDate.toISOString();const{data:comparisonEvents}=await supabase.from(\"collab_link_events\").select(\"event_type\").eq(\"creator_id\",userId).gte(\"created_at\",comparisonStartDateStr).lt(\"created_at\",startDateStr);const comparisonViews=comparisonEvents?.filter(e=>e.event_type===\"view\").length||0;const comparisonSubmissions=comparisonEvents?.filter(e=>e.event_type===\"submit\").length||0;const viewsTrend=comparisonViews>0?(views-comparisonViews)/comparisonViews*100:views>0?100:0;const submissionsTrend=comparisonSubmissions>0?(submissions-comparisonSubmissions)/comparisonSubmissions*100:submissions>0?100:0;const uniqueViews=new Set(events.filter(e=>e.event_type===\"view\").map(e=>e.ip_hash||\"unknown\")).size;res.json({success:true,analytics:{period:daysNum,views:{total:views,unique:uniqueViews,trend:viewsTrend,trendDirection:viewsTrend>=0?\"up\":\"down\"},submissions:{total:submissions,trend:submissionsTrend,trendDirection:submissionsTrend>=0?\"up\":\"down\"},conversionRate:{value:Math.round(conversionRate*10)/10,trend:comparisonViews>0?conversionRate-comparisonSubmissions/comparisonViews*100:conversionRate,trendDirection:comparisonViews>0?conversionRate-comparisonSubmissions/comparisonViews*100>=0?\"up\":\"down\":\"neutral\"},deviceBreakdown}})}catch(error){console.error(\"[CollabAnalytics] Error in GET /:\",error);res.status(500).json({success:false,error:\"Internal server error\"})}});router.get(\"/summary\",authMiddleware,async(req,res)=>{try{const userId=req.user.id;console.log(\"[CollabAnalytics] GET /summary - User ID:\",userId);const sevenDaysAgo=new Date;sevenDaysAgo.setDate(sevenDaysAgo.getDate()-7);const sevenDaysAgoStr=sevenDaysAgo.toISOString();console.log(\"[CollabAnalytics] Fetching events for creator_id:\",userId);console.log(\"[CollabAnalytics] Supabase client initialized:\",supabaseInitialized);let allTimeEvents=null;let allTimeError=null;try{const result=await supabase.from(\"collab_link_events\").select(\"event_type, ip_hash, created_at\").eq(\"creator_id\",userId);allTimeEvents=result.data;allTimeError=result.error;console.log(\"[CollabAnalytics] Query result:\",{hasData:!!allTimeEvents,dataLength:allTimeEvents?.length||0,hasError:!!allTimeError,errorCode:allTimeError?.code,errorMessage:allTimeError?.message})}catch(queryError){console.error(\"[CollabAnalytics] Query exception:\",queryError);allTimeError=queryError}if(allTimeError){console.error(\"[CollabAnalytics] Error fetching all-time events:\",allTimeError);console.error(\"[CollabAnalytics] Error code:\",allTimeError.code);console.error(\"[CollabAnalytics] Error message:\",allTimeError.message);console.error(\"[CollabAnalytics] Error details:\",JSON.stringify(allTimeError,null,2));console.error(\"[CollabAnalytics] Error hint:\",allTimeError.hint);console.error(\"[CollabAnalytics] User ID:\",userId);console.error(\"[CollabAnalytics] Supabase initialized:\",supabaseInitialized);return res.status(500).json({success:false,error:\"Failed to fetch analytics\",details:process.env.NODE_ENV===\"development\"?{message:allTimeError.message,code:allTimeError.code,hint:allTimeError.hint,details:allTimeError.details,fullError:JSON.stringify(allTimeError,null,2)}:void 0,code:allTimeError.code})}console.log(\"[CollabAnalytics] Fetched\",allTimeEvents?.length||0,\"events\");const weeklyEvents=allTimeEvents?.filter(e=>new Date(e.created_at)>=sevenDaysAgo)||[];const weeklyUniqueViews=new Set(weeklyEvents.filter(e=>e.event_type===\"view\").map(e=>e.ip_hash||\"unknown\")).size;const weeklyViews=weeklyEvents.filter(e=>e.event_type===\"view\").length;const weeklySubmissions=weeklyEvents.filter(e=>e.event_type===\"submit\").length;const totalUniqueViews=new Set(allTimeEvents?.filter(e=>e.event_type===\"view\").map(e=>e.ip_hash||\"unknown\")||[]).size;const totalViews=allTimeEvents?.filter(e=>e.event_type===\"view\").length||0;const totalSubmissions=allTimeEvents?.filter(e=>e.event_type===\"submit\").length||0;console.log(\"[CollabAnalytics] Summary calculated:\",{weeklyUniqueViews,totalUniqueViews,totalSubmissions,weeklySubmissions});res.json({success:true,weeklyViews:weeklyUniqueViews,totalViews:totalUniqueViews,submissions:totalSubmissions,weeklySubmissions})}catch(error){console.error(\"[CollabAnalytics] Error in GET /summary:\",error);console.error(\"[CollabAnalytics] Error stack:\",error.stack);res.status(500).json({success:false,error:\"Internal server error\",details:process.env.NODE_ENV===\"development\"?error.message:void 0})}});var collabAnalytics_default=router;export{collabAnalytics_default as default};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/routes/collabAnalytics.ts"],"sourcesContent":[null]}}