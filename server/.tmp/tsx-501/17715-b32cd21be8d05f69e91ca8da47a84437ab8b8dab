{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{getEmailLayout,getPrimaryCTA,getEmailSignal,getFirstName}from\"./professionalEmailTemplates.js\";async function sendEmail(to,subject,html){try{const apiKey=process.env.RESEND_API_KEY;if(!apiKey||apiKey===\"your_resend_api_key_here\"||!apiKey.trim()){console.error(\"[ShippingEmail] RESEND_API_KEY not configured\");return{success:false,error:\"Email not configured\"}}const emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!emailRegex.test(to))return{success:false,error:\"Invalid email\"};const res=await fetch(\"https://api.resend.com/emails\",{method:\"POST\",headers:{Authorization:`Bearer ${apiKey}`,\"Content-Type\":\"application/json\"},body:JSON.stringify({from:\"CreatorArmour <noreply@creatorarmour.com>\",to,subject,html})});if(!res.ok){const data=await res.json().catch(()=>({}));return{success:false,error:data.message||res.statusText}}return{success:true}}catch(e){console.error(\"[ShippingEmail] Exception:\",e);return{success:false,error:e?.message||\"Send failed\"}}}__name(sendEmail,\"sendEmail\");async function sendBrandShippingUpdateEmail(brandEmail,data){const content=`\n    <p style=\"color: #4b5563; font-size: 16px;\">\n      Your barter collaboration with <strong>${data.creatorName}</strong> is confirmed. Please ship the product and update the shipping details so the creator can track the delivery.\n    </p>\n    <div style=\"background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 15px; margin: 20px 0;\">\n      <p style=\"color: #92400e; font-size: 14px; margin: 0;\">\n        <strong>Status: SHIPPING_IN_PROGRESS</strong><br>\n        <strong>Product:</strong> ${data.productDescription||\"As per agreement\"}\n      </p>\n    </div>\n    <p style=\"color: #4b5563; font-size: 14px; font-weight: 500;\">\n      Creators are notified instantly when tracking is added. Delaying shipment may affect delivery timelines and protection status.\n    </p>\n    <p style=\"color: #6b7280; font-size: 14px;\">\n      Use the button below to add courier name, tracking number, and tracking URL.\n    </p>\n  `;const html=`\n    <!DOCTYPE html>\n    <html>\n      <head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"></head>\n      <body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px 10px 0 0; text-align: center;\">\n          <h1 style=\"color: white; margin: 0; font-size: 24px;\">Action required: Ship product</h1>\n        </div>\n        <div style=\"background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; border: 1px solid #e5e7eb;\">\n          <h2 style=\"color: #1f2937; margin-top: 0;\">Hello ${data.brandName},</h2>\n          ${content}\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${data.shippingLink}\" style=\"display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 28px; text-decoration: none; border-radius: 8px; font-weight: 600;\" target=\"_blank\" rel=\"noopener noreferrer\">Update Shipping Details</a>\n          </div>\n        </div>\n      </body>\n    </html>\n  `;return sendEmail(brandEmail,`Action required: Ship product to ${data.creatorName} (Collaboration Active)`,html)}__name(sendBrandShippingUpdateEmail,\"sendBrandShippingUpdateEmail\");async function sendCreatorProductShippedEmail(creatorEmail,data){const mainContent=`\n      <tr>\n        <td style=\"background-color: #667eea; padding: 40px 30px; text-align: center;\">\n          <h1 style=\"color: #ffffff; margin: 0; font-size: 24px;\">\\u{1F4E6} Product Shipped!</h1>\n        </td>\n      </tr>\n      ${getEmailSignal({type:\"happened\",message:\"The brand has shipped your product. Your deliverables timeline will activate once you confirm delivery.\"})}\n      <tr>\n        <td style=\"padding: 40px 30px;\">\n          <p style=\"margin: 0 0 20px 0; font-size: 16px; color: #2d3748; line-height: 1.6;\">\n            Hi ${getFirstName(data.creatorName)},\n          </p>\n          <p style=\"margin: 0 0 24px 0; font-size: 15px; color: #4a5568; line-height: 1.6;\">\n            <strong>${data.brandName}</strong> has marked your barter product as shipped. You can track your delivery using the details below.\n          </p>\n          \n          <div style=\"background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; margin: 24px 0;\">\n            <div style=\"margin-bottom: 12px;\">\n              <strong style=\"color: #64748b; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;\">Courier</strong>\n              <div style=\"color: #1e293b; font-size: 16px; font-weight: 600;\">${data.courierName}</div>\n            </div>\n            <div style=\"margin-bottom: 12px;\">\n              <strong style=\"color: #64748b; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;\">Tracking Number</strong>\n              <div style=\"color: #1e293b; font-size: 16px; font-weight: 600;\">${data.trackingNumber}</div>\n            </div>\n            ${data.trackingUrl?`\n            <div style=\"margin-top: 16px;\">\n              <a href=\"${data.trackingUrl}\" style=\"color: #6366f1; text-decoration: none; font-weight: 600; font-size: 14px;\">Track Delivery \\u2192</a>\n            </div>\n            `:\"\"}\n          </div>\n\n          <p style=\"color: #4b5563; font-size: 14px; line-height: 1.6; margin-top: 24px;\">\n            Reminder: Confirm receipt of the product in your dashboard as soon as it arrives. This ensures the timer for your deliverables starts accurately.\n          </p>\n          \n          ${getPrimaryCTA(\"View Collaboration\",`${process.env.FRONTEND_URL||\"https://creatorarmour.com\"}/creator-contracts`)}\n        </td>\n      </tr>\n    `;const html=getEmailLayout({content:mainContent,showFooter:true});return sendEmail(creatorEmail,\"Product shipped \\u2014 track your delivery\",html)}__name(sendCreatorProductShippedEmail,\"sendCreatorProductShippedEmail\");async function sendCreatorDeliveryConfirmedEmail(creatorEmail,creatorName,brandName,dealId){const mainContent=`\n    <tr>\n      <td style=\"background-color: #10b981; padding: 40px 30px; text-align: center;\">\n        <h1 style=\"color: #ffffff; margin: 0; font-size: 24px;\">\\u{1F69A} Delivery Confirmed!</h1>\n      </td>\n    </tr>\n    ${getEmailSignal({type:\"happened\",message:\"Delivery confirmed \\u2014 your deliverables timeline is now officially activated.\"})}\n    <tr>\n      <td style=\"padding: 40px 30px;\">\n        <p style=\"margin: 0 0 20px 0; font-size: 16px; color: #2d3748; line-height: 1.6;\">\n          Hi ${getFirstName(creatorName)},\n        </p>\n        <p style=\"margin: 0 0 24px 0; font-size: 15px; color: #4a5568; line-height: 1.6;\">\n          You've confirmed receipt of the product from <strong>${brandName}</strong>. \n          As per your agreement, the countdown for your deliverables has started.\n        </p>\n        \n        <p style=\"margin: 0 0 24px 0; font-size: 15px; color: #4a5568; line-height: 1.6;\">\n          Please ensure all content is submitted through the Creator Armour dashboard before the deadline to maintain your standing and protection.\n        </p>\n        \n        ${getPrimaryCTA(\"View Timeline & Deliverables\",`${process.env.FRONTEND_URL||\"https://creatorarmour.com\"}/creator-contracts/${dealId}`)}\n      </td>\n    </tr>\n  `;const html=getEmailLayout({content:mainContent,showFooter:true});return sendEmail(creatorEmail,\"Delivery confirmed \\u2014 deliverables timeline activated\",html)}__name(sendCreatorDeliveryConfirmedEmail,\"sendCreatorDeliveryConfirmedEmail\");async function sendBrandShippingIssueEmail(brandEmail,data){const content=`\n    <p style=\"color: #4b5563; font-size: 16px;\">\n      <strong>${data.creatorName}</strong> has reported an issue with the barter product shipment.\n    </p>\n    <div style=\"background: #fef2f2; border: 1px solid #ef4444; border-radius: 8px; padding: 15px; margin: 20px 0;\">\n      <p style=\"color: #991b1b; font-size: 14px; margin: 0;\"><strong>Reason:</strong></p>\n      <p style=\"color: #991b1b; font-size: 14px; margin: 8px 0 0 0;\">${data.reason||\"No details provided.\"}</p>\n    </div>\n    <p style=\"color: #6b7280; font-size: 14px;\">\n      Please reach out to the creator to resolve this. You can also use legal support if needed.\n    </p>\n  `;const html=`\n    <!DOCTYPE html>\n    <html>\n      <head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"></head>\n      <body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px 10px 0 0; text-align: center;\">\n          <h1 style=\"color: white; margin: 0; font-size: 24px;\">Shipping issue reported</h1>\n        </div>\n        <div style=\"background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; border: 1px solid #e5e7eb;\">\n          <h2 style=\"color: #1f2937; margin-top: 0;\">Hello ${data.brandName},</h2>\n          ${content}\n        </div>\n      </body>\n    </html>\n  `;return sendEmail(brandEmail,\"Creator reported a shipping issue \\u2013 barter collaboration\",html)}__name(sendBrandShippingIssueEmail,\"sendBrandShippingIssueEmail\");export{sendBrandShippingIssueEmail,sendBrandShippingUpdateEmail,sendCreatorDeliveryConfirmedEmail,sendCreatorProductShippedEmail};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/pratyushraj/Documents/noticebazaar/server/src/services/shippingEmailService.ts"],"sourcesContent":[null]}}